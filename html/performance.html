<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Personal Dashboard View</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="icon" type="image/png" href="/assets/logo.png" />
    <link rel="stylesheet" href="/css/performance.css" />
    <link rel="stylesheet" href="/css/profile-details.css" />
    <style>
      label[type="date"],
      button.primary,
      #eventPopup button {
        font-family: "Inter", sans-serif;
      }

      .primary {
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <!-- Update the header section -->
    <header class="header">
      <nav class="nav-left">
        <button id="back-btn">
          <i class="fas fa-arrow-left"></i>
        </button>
        <button id="profile-btn">Profile Details</button>
        <button id="performance-btn" class="active-tab">Performance</button>
      </nav>
      <div class="nav-right">
        <span id="current-time" class="hide-mobile">10:08 PM GMT+8</span>
        <div class="icons">
          <div class="notification-wrapper">
            <button id="notifBtn" class="icon-btn">
              <i class="fas fa-bell"></i>
            </button>
            <div class="notif-dropdown" id="notifDropdown">
              <!-- Notification content -->
            </div>
          </div>
          <button class="avatar" id="userBtn">
            <i class="fas fa-user"></i>
          </button>
        </div>
      </div>
    </header>
    <div class="container">
      <aside></aside>
      <main>
        <h1>Hello, Member Name</h1>

        <label
          style="
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            background: transparent;
            color: white;
          "
        >
          This is your personal dashboard showing your performance and
          participation in church events.
        </label>

        <div class="insights">
          <!-- start seling -->
          <!-- Total Events -->
          <div class="sales">
            <span class="material-symbols-sharp">event</span>
            <div class="middle">
              <div class="left">
                <h3>Total Events</h3>
                <h1 id="total-events">0</h1>
              </div>
              <div class="progress">
                <svg width="80" height="80">
                  <circle class="bg" r="30" cx="40" cy="40"></circle>
                  <circle class="progress-ring" r="30" cx="40" cy="40"></circle>
                </svg>
                <div class="number" id="total-percentage"><p>100%</p></div>
              </div>
            </div>
            <small>This Year</small>
          </div>

          <!-- Attended Events -->
          <div class="expenses">
            <span class="material-symbols-sharp">check_circle</span>
            <div class="middle">
              <div class="left">
                <h3>Attended Events</h3>
                <h1 id="attended-events">0</h1>
              </div>
              <div class="progress">
                <svg width="80" height="80">
                  <circle class="bg" r="30" cx="40" cy="40"></circle>
                  <circle class="progress-ring" r="30" cx="40" cy="40"></circle>
                </svg>
                <div class="number" id="attended-percentage"><p>0%</p></div>
              </div>
            </div>
            <small>Updated Weekly</small>
          </div>

          <!-- Participation Rate -->
          <div class="income">
            <span class="material-symbols-sharp">leaderboard</span>
            <div class="middle">
              <div class="left">
                <h3>Participation Rate</h3>
                <h1 id="participation-rate">0%</h1>
              </div>
              <div class="progress">
                <svg width="80" height="80">
                  <circle class="bg" r="30" cx="40" cy="40"></circle>
                  <circle class="progress-ring" r="30" cx="40" cy="40"></circle>
                </svg>
                <div class="number" id="rate-percentage"><p>0%</p></div>
              </div>
            </div>
            <small>As of Today</small>
          </div>

          <!-- end seling -->
        </div>
        <!-- end insights -->
        <div class="attended_events">
          <h2>Attended Church Events</h2>
          <table>
            <thead>
              <tr>
                <th>Event Name</th>
                <th>Event Date</th>
                <th></th>
                <!-- View button column -->
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Sunday Worship Service</td>
                <td>2025-06-08</td>
                <td>
                  <button
                    class="primary"
                    onclick="showEventPopup('Sunday Worship Service', '08:50 AM')"
                  >
                    View Event
                  </button>
                </td>
              </tr>
              <tr>
                <td>Men’s Fellowship Night</td>
                <td>2025-05-30</td>
                <td>
                  <button
                    class="primary"
                    onclick="showEventPopup('Men’s Fellowship Night', '06:30 PM')"
                  >
                    View Event
                  </button>
                </td>
              </tr>
              <tr>
                <td>Youth Bible Camp</td>
                <td>2025-05-18</td>
                <td>
                  <button
                    class="primary"
                    onclick="showEventPopup('Youth Bible Camp', '07:15 AM')"
                  >
                    View Event
                  </button>
                </td>
              </tr>
              <tr>
                <td>Prayer & Healing Night</td>
                <td>2025-04-25</td>
                <td>
                  <button
                    class="primary"
                    onclick="showEventPopup('Prayer & Healing Night', '06:00 PM')"
                  >
                    View Event
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <a href="#">Show All</a>
        </div>

        <!-- Popup Modal -->
        <div
          id="eventPopup"
          style="
            display: none;
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border: 1px solid #ccc;
            padding: 40px 30px;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            text-align: center;
          "
        >
          <p id="eventDetails" style="margin-bottom: 20px; font-size: 18px"></p>
          <button
            onclick="closePopup()"
            style="
              padding: 10px 20px;
              font-size: 16px;
              font-family: 'Inter', sans-serif;
            "
          >
            Close
          </button>
        </div>
      </main>
      <!------------------
         end main
        ------------------->

      <!----------------
        start right main 
      ---------------------->
      <div class="right"></div>
    </div>
    <script src="script.js"></script>
    <script>
      // Example data
      const totalEvents = 12;
      const attendedEvents = 6;
      const participation = Math.round((attendedEvents / totalEvents) * 100);

      function updateProgress(idPrefix, valuePercent) {
        const circle = document.querySelector(`#${idPrefix} .progress-ring`);
        const text = document
          .getElementById(`${idPrefix}-percentage`)
          .querySelector("p");

        const radius = 30;
        const circumference = 2 * Math.PI * radius;
        const offset = circumference * (1 - valuePercent / 100);

        circle.style.strokeDasharray = `${circumference}`;
        circle.style.strokeDashoffset = offset;

        text.textContent = `${valuePercent}%`;
      }

      function setStats() {
        document.getElementById("total-events").textContent = totalEvents;
        document.getElementById("attended-events").textContent = attendedEvents;
        document.getElementById(
          "participation-rate"
        ).textContent = `${participation}%`;

        updateProgress("sales", 100); // Total Events (always 100%)
        updateProgress("expenses", (attendedEvents / totalEvents) * 100); // Attendance
        updateProgress("income", participation); // Participation rate
      }

      // Trigger after DOM is ready
      document.addEventListener("DOMContentLoaded", setStats);
    </script>
    <script>
      function showEventPopup(eventTitle, checkInTime) {
        document.getElementById("eventDetails").textContent =
          "Title of the event attended: " +
          eventTitle +
          " | Time in (QR scanned): " +
          checkInTime;
        document.getElementById("eventPopup").style.display = "block";
      }

      function closePopup() {
        document.getElementById("eventPopup").style.display = "none";
      }
    </script>
    <script>
      document
        .getElementById("back-btn")
        .addEventListener("click", function () {
          window.location.href = "user-dashboard.html";
        });
    </script>
    <script>
      // Toggle the notification dropdown
      document
        .getElementById("notifBtn")
        .addEventListener("click", function () {
          const dropdown = document.getElementById("notifDropdown");
          dropdown.style.display =
            dropdown.style.display === "block" ? "none" : "block";
        });

      // Redirect to another page on avatar click
      document.getElementById("userBtn").addEventListener("click", function () {
        window.location.href = "profile-details.html";
      });

      // Optional: hide dropdown if clicked outside
      window.addEventListener("click", function (event) {
        const dropdown = document.getElementById("notifDropdown");
        if (!event.target.closest(".notification-wrapper")) {
          dropdown.style.display = "none";
        }
      });
    </script>
    <script>
      document
        .getElementById("profile-btn")
        .addEventListener("click", function () {
          window.location.href = "profile-details.html";
        });
    </script>
  </body>
</html>
